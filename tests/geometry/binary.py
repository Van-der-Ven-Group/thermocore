import pytest
import numpy as np
from scipy.spatial import ConvexHull


@pytest.fixture
def binary_points():
    return np.array(
        [
            [5, 5],
            [1, 3],
            [5, 0],
            [1, 8],
            [7, 7],
            [1, 1],
            [3, 8],
            [9, 7],
            [6, 6],
            [4, 3],
            [3, 9],
            [5, 9],
            [4, 2],
            [2, 9],
            [7, 3],
            [8, 4],
            [9, 2],
            [5, 7],
            [6, 4],
            [8, 8],
            [6, 5],
            [6, 9],
            [5, 2],
            [8, 3],
            [0, 8],
        ],
        dtype=float,
    )


@pytest.fixture
def binary_lower_hull_vertex_indices():
    return np.array([2, 5, 16, 24])


@pytest.fixture
def binary_lower_hull_simplices():
    return np.array([[24, 5], [5, 2], [2, 16]])


@pytest.fixture
def binary_hull(binary_points):
    return ConvexHull(binary_points)


@pytest.fixture
def binary_lower_hull_simplex_indices(binary_hull, binary_lower_hull_simplices):
    return np.array(
        [
            [frozenset(simplex) for simplex in binary_hull.simplices].index(
                frozenset(known_simplex)
            )
            for known_simplex in binary_lower_hull_simplices
        ]
    )


@pytest.fixture
def ZrN_FCC_composition_subset():
    return np.array(
        [
            [1.0],
            [0.0],
            [0.5],
            [0.5],
            [0.66666667],
            [0.33333333],
            [0.66666667],
            [0.33333333],
            [0.66666667],
            [0.33333333],
            [0.75],
            [0.25],
            [0.75],
            [0.25],
            [0.75],
            [0.5],
            [0.25],
            [0.75],
            [0.5],
            [0.25],
            [0.75],
            [0.5],
            [0.25],
            [0.81818182],
            [0.85714286],
            [0.78571429],
            [0.71428571],
        ]
    )


@pytest.fixture
def ZrN_FCC_formation_energy_subset():
    return np.array(
        [
            0.0,
            0.0395892,
            -0.01393525,
            -0.03327425,
            -0.064273166667,
            0.023239666667,
            -0.103522166667,
            -0.046862333333,
            0.0151045,
            0.015255666667,
            -0.081953125,
            0.001995375,
            0.040625625,
            -0.031316375,
            -0.035709625,
            0.02008725,
            0.022540875,
            -0.097980125,
            -0.0470245,
            0.017668875,
            -0.020893875,
            -0.13249325,
            -0.048072875,
            -0.087823818182,
            -0.077515785714,
            -0.093667178571,
            -0.106433571429,
        ]
    )


@pytest.fixture
def ZrN_FCC_corr_subset():
    return np.array(
        [
            [
                1.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
                0.0,
            ],
            [
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
                1.0,
            ],
            [
                1.0,
                0.5,
                0.166666666667,
                0.5,
                0.166666666667,
                0.5,
                0.166666666667,
                0.5,
            ],
            [
                1.0,
                0.5,
                0.25,
                0.0,
                0.25,
                0.5,
                0.25,
                0.0,
            ],
            [
                1.0,
                0.333333333333,
                0.111111111111,
                0.222222222222,
                0.0,
                0.111111111111,
                0.222222222222,
                0.0,
            ],
            [
                1.0,
                0.666666666667,
                0.444444444444,
                0.555555555556,
                0.333333333333,
                0.444444444444,
                0.555555555556,
                0.333333333333,
            ],
            [
                1.0,
                0.333333333333,
                0.055555555556,
                0.111111111111,
                0.166666666667,
                0.055555555556,
                0.111111111111,
                0.166666666667,
            ],
            [
                1.0,
                0.666666666667,
                0.388888888889,
                0.444444444444,
                0.5,
                0.388888888889,
                0.444444444444,
                0.5,
            ],
            [
                1.0,
                0.333333333333,
                0.166666666667,
                0.0,
                0.083333333333,
                0.166666666667,
                0.0,
                0.083333333333,
            ],
            [
                1.0,
                0.666666666667,
                0.5,
                0.333333333333,
                0.416666666667,
                0.5,
                0.333333333333,
                0.416666666667,
            ],
            [
                1.0,
                0.25,
                0.041666666667,
                0.0,
                0.041666666667,
                0.25,
                0.041666666667,
                0.0,
            ],
            [
                1.0,
                0.75,
                0.541666666667,
                0.5,
                0.541666666667,
                0.75,
                0.541666666667,
                0.5,
            ],
            [
                1.0,
                0.25,
                0.0,
                0.25,
                0.0,
                0.25,
                0.0,
                0.25,
            ],
            [
                1.0,
                0.75,
                0.5,
                0.75,
                0.5,
                0.75,
                0.5,
                0.75,
            ],
            [
                1.0,
                0.25,
                0.125,
                0.0,
                0.0625,
                0.125,
                0.0,
                0.0,
            ],
            [
                1.0,
                0.5,
                0.375,
                0.25,
                0.25,
                0.25,
                0.125,
                0.25,
            ],
            [
                1.0,
                0.75,
                0.625,
                0.5,
                0.5625,
                0.625,
                0.5,
                0.5,
            ],
            [
                1.0,
                0.25,
                0.041666666667,
                0.0,
                0.0625,
                0.125,
                0.083333333333,
                0.0,
            ],
            [
                1.0,
                0.5,
                0.208333333333,
                0.25,
                0.25,
                0.25,
                0.291666666667,
                0.25,
            ],
            [
                1.0,
                0.75,
                0.541666666667,
                0.5,
                0.5625,
                0.625,
                0.583333333333,
                0.5,
            ],
            [
                1.0,
                0.25,
                0.083333333333,
                0.166666666667,
                0.0,
                0.083333333333,
                0.083333333333,
                0.0,
            ],
            [
                1.0,
                0.5,
                0.166666666667,
                0.333333333333,
                0.333333333333,
                0.166666666667,
                0.166666666667,
                0.0,
            ],
            [
                1.0,
                0.75,
                0.5,
                0.666666666667,
                0.583333333333,
                0.583333333333,
                0.5,
                0.5,
            ],
            [
                1.0,
                0.181818181818,
                0.0,
                0.030303030303,
                0.060606060606,
                0.015151515152,
                0.030303030303,
                0.0,
            ],
            [
                1.0,
                0.142857142857,
                0.0,
                0.0,
                0.029761904762,
                0.047619047619,
                0.02380952381,
                0.0,
            ],
            [
                1.0,
                0.214285714286,
                0.02380952381,
                0.0,
                0.059523809524,
                0.083333333333,
                0.053571428571,
                0.0,
            ],
            [
                1.0,
                0.285714285714,
                0.047619047619,
                0.047619047619,
                0.10119047619,
                0.095238095238,
                0.095238095238,
                0.071428571429,
            ],
        ]
    )
